<script>
    (function () {
        var checkItemInterval;


        /**
         *  Remove interval when done
         */
        function removeCheckItemInterval() {
            clearInterval(checkItemInterval);
        }

        /**
         * check item for deletion
         */
        function checkItem() {
            google.script.run
                    .withSuccessHandler(function (isDeleted) {
                        if (isDeleted) {
                            removeCheckItemInterval();
                            google.script.run.showSidebar();
                        }
                    })
                    .checkEventDeletion();

            google.script.run
                    .checkFormItemValue();
        }

        // Check every 10 seconds
        checkItemInterval = setInterval(checkItem, 1000);
    }());
</script>
